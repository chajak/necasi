<?php
    namespace services\parsers\specific;

    use services\parsers as Parsers;

    class MeteorParser extends Parsers\JsonParser {
        private $apiRunData;

        public function __construct() {
            parent::__construct();

            //call this after
            $this->parserVersion = "1.0";
            $this->model->name = $this->whoAmI();
        }

        public function setApiRunData($apiRunData) {
            $this->apiRunData = $apiRunData;
        }

        public function parse($rawJson) {
            parent::parse($rawJson);

            $this->buildDataModel();

            return $this->model;
        }

        private function buildDataModel() {
            if(!empty($this->json)) {
                $this->processData();
                $this->processList();
            }
        }

        private function processData() {
            $this->model->created = $this->getFormatedDateTimeStringFromTimestamp(time());
            $this->model->validTo = $this->getFormatedDateTimeString($this->apiRunData["validTo"]);
            $this->model->from = $this->getFormatedDateTimeString($this->apiRunData["from"]);
            $this->model->to = $this->getFormatedDateTimeString($this->apiRunData["to"]);
        }

        private function processList() {
            print_r($this->json);
            /*
stdClass Object
(
    [start] => 1518955200
    [step] => 3600
    [end] => 1519236000
    [lat] => 50.1005785
    [data] => stdClass Object
        (
            [wdir] => stdClass Object
                (
                    [max] => 360
                    [values] => Array
                        (
                            [0] => 173.37576293945
                            [1] => 177.42248535156
                            [2] => -172.60472106934
                            [3] => -167.10166931152
                            [4] => -159.17588806152
                            [5] => -102.7082901001
                            [6] => -22.718399047852
                            [7] => -5.334011554718
                            [8] => -9.9832859039307
                            [9] => -8.1736888885498
                            [10] => -8.8069477081299
                            [11] => -18.566802978516
                            [12] => -22.860679626465
                            [13] => -15.721364974976
                            [14] => -9.5719938278198
                            [15] => -9.7566890716553
                            [16] => -10.374026298523
                            [17] => -13.553153038025
                            [18] => -13.745641708374
                            [19] => -15.596017837524
                            [20] => -23.309978485107
                            [21] => -35.61682510376
                            [22] => -48.10266494751
                            [23] => -59.921298980713
                            [24] => -65.153274536133
                            [25] => -59.865871429443
                            [26] => -59.66641998291
                            [27] => -59.475608825684
                            [28] => -57.380916595459
                            [29] => -60.765098571777
                            [30] => -57.579414367676
                            [31] => -71.574264526367
                            [32] => -79.650527954102
                            [33] => -84.872695922852
                            [34] => -84.000885009766
                            [35] => -84.93115234375
                            [36] => -84.052406311035
                            [37] => -80.702766418457
                            [38] => -79.856460571289
                            [39] => -81.985610961914
                            [40] => -82.574676513672
                            [41] => -83.262390136719
                            [42] => -84.08032989502
                            [43] => -86.085060119629
                            [44] => -85.727752685547
                            [45] => -83.912727355957
                            [46] => -81.403831481934
                            [47] => -84.378952026367
                            [48] => -99.57300567627
                            [49] => -102.06122589111
                            [50] => -105.912940979
                            [51] => -113.29663085938
                            [52] => -134.92971801758
                            [53] => -141.30526733398
                            [54] => -120.09600067139
                            [55] => -124.41017150879
                            [56] => -124.10244750977
                            [57] => -142.40061950684
                            [58] => -155.19389343262
                            [59] => -160.59307861328
                            [60] => -163.54829406738
                            [61] => -165.74136352539
                            [62] => 20.183334350586
                            [63] => 18.953741073608
                            [64] => 10.057178497314
                            [65] => 4.4126873016357
                            [66] => 8.0987501144409
                            [67] => 13.662197113037
                            [68] => -167.21133422852
                            [69] => -13.081266403198
                            [70] => -168.69013977051
                            [71] => -163.89172363281
                            [72] => -159.11505126953
                            [73] => -148.83134460449
                            [74] => -142.90196228027
                            [75] => -138.51866149902
                            [76] => -147.99078369141
                            [77] => -161.01135253906
                            [78] => -154.9931640625
                        )

                    [min] => 0
                )

            [cloud_low] => stdClass Object
                (
                    [max] => 1
                    [values] => Array
                        (
                            [0] => 0.32372343540192
                            [1] => 0.53056740760803
                            [2] => 0
                            [3] => 0
                            [4] => 0.21521881222725
                            [5] => 0.4034760594368
                            [6] => 0.60128021240234
                            [7] => 0
                            [8] => 0
                            [9] => 0
                            [10] => 0
                            [11] => 0
                            [12] => 0
                            [13] => 0
                            [14] => 0
                            [15] => 1
                            [16] => 1
                            [17] => 0.71545886993408
                            [18] => 0
                            [19] => 0
                            [20] => 0
                            [21] => 0
                            [22] => 0
                            [23] => 0
                            [24] => 0
                            [25] => 0
                            [26] => 0
                            [27] => 0
                            [28] => 0
                            [29] => 0
                            [30] => 0
                            [31] => 0
                            [32] => 0
                            [33] => 0
                            [34] => 0
                            [35] => 0
                            [36] => 0
                            [37] => 0
                            [38] => 0
                            [39] => 0
                            [40] => 0
                            [41] => 0
                            [42] => 0
                            [43] => 0
                            [44] => 0
                            [45] => 0
                            [46] => 0
                            [47] => 0
                            [48] => 0
                            [49] => 0
                            [50] => 0
                            [51] => 0
                            [52] => 0
                            [53] => 0
                            [54] => 0
                            [55] => 0
                            [56] => 0
                            [57] => 0
                            [58] => 0
                            [59] => 0
                            [60] => 0
                            [61] => 0
                            [62] => 0
                            [63] => 0
                            [64] => 0
                            [65] => 0
                            [66] => 0
                            [67] => 0
                            [68] => 0
                            [69] => 0
                            [70] => 0
                            [71] => 0
                            [72] => 0
                            [73] => 0
                            [74] => 0
                            [75] => 0
                            [76] => 0
                            [77] => 0
                            [78] => 0
                        )

                    [unit] => stdClass Object
                        (
                            [cz] => %
                            [gb] => %
                        )

                    [min] => 0
                )

            [t2c] => stdClass Object
                (
                    [values] => Array
                        (
                            [0] => 3.2517409324646
                            [1] => 3.7608466148376
                            [2] => 4.0256538391113
                            [3] => 3.9912192821503
                            [4] => 3.6763601303101
                            [5] => 2.739734172821
                            [6] => 1.7485270500183
                            [7] => 0.84453558921814
                            [8] => 0.16688853502274
                            [9] => -0.2363632619381
                            [10] => -0.42787486314774
                            [11] => -0.63051551580429
                            [12] => -0.88960266113281
                            [13] => -1.2350364923477
                            [14] => -1.815087556839
                            [15] => -2.5645380020142
                            [16] => -2.7312316894531
                            [17] => -2.620676279068
                            [18] => -2.6735560894012
                            [19] => -2.7165997028351
                            [20] => -2.2771580219269
                            [21] => -1.4468678236008
                            [22] => -0.56105667352676
                            [23] => 0.30904942750931
                            [24] => 1.3023438453674
                            [25] => 2.2741146087646
                            [26] => 2.7834012508392
                            [27] => 2.781501531601
                            [28] => 2.1716723442078
                            [29] => 1.4043551683426
                            [30] => 0.60105001926422
                            [31] => -0.091977261006832
                            [32] => -0.59452331066132
                            [33] => -0.79430377483368
                            [34] => -0.97674834728241
                            [35] => -1.1652200222015
                            [36] => -1.3111531734467
                            [37] => -1.4270578622818
                            [38] => -1.5229914188385
                            [39] => -1.7484378814697
                            [40] => -1.8399902582169
                            [41] => -1.9049257040024
                            [42] => -2.0235719680786
                            [43] => -1.9340718984604
                            [44] => -1.3790627717972
                            [45] => -0.48585233092308
                            [46] => 0.48897302150726
                            [47] => 1.3306407928467
                            [48] => 2.0361824035645
                            [49] => 1.982045173645
                            [50] => 2.4444987773895
                            [51] => 2.6306099891663
                            [52] => 2.2955656051636
                            [53] => 1.1996854543686
                            [54] => 0.19757993519306
                            [55] => -0.33340418338776
                            [56] => -0.86209619045258
                            [57] => -1.2958389520645
                            [58] => -1.541047334671
                            [59] => -1.7052015066147
                            [60] => -1.8237136602402
                            [61] => -1.9246768951416
                            [62] => -2.0371074676514
                            [63] => -2.1262683868408
                            [64] => -2.3619661331177
                            [65] => -2.5868606567383
                            [66] => -2.804384469986
                            [67] => -2.754702091217
                            [68] => -2.001184463501
                            [69] => -1.0261240005493
                            [70] => 0.091113314032555
                            [71] => 1.1508429050446
                            [72] => 1.9295846223831
                            [73] => 2.6022751331329
                            [74] => 2.9770021438599
                            [75] => 2.6814308166504
                            [76] => 1.4631646871567
                            [77] => -0.073574729263783
                            [78] => -1.1138250827789
                        )

                    [unit] => stdClass Object
                        (
                            [cz] => °C
                            [gb] => °C
                        )

                    [min] => -10
                    [max] => 15
                    [poi] => stdClass Object
                        (
                            [max] => Array
                                (
                                    [0] => 1518962400
                                )

                            [min] => Array
                                (
                                    [0] => 1519192800
                                )

                        )

                    [gridStep] => 5
                )

            [daylight] => Array
                (
                    [0] => stdClass Object
                        (
                            [type] => sunset
                            [time] => 1518971100
                        )

                    [1] => stdClass Object
                        (
                            [type] => sunrise
                            [time] => 1519020900
                        )

                    [2] => stdClass Object
                        (
                            [type] => sunset
                            [time] => 1519057500
                        )

                    [3] => stdClass Object
                        (
                            [type] => sunrise
                            [time] => 1519106700
                        )

                    [4] => stdClass Object
                        (
                            [type] => sunset
                            [time] => 1519143900
                        )

                    [5] => stdClass Object
                        (
                            [type] => sunrise
                            [time] => 1519193100
                        )

                    [6] => stdClass Object
                        (
                            [type] => sunset
                            [time] => 1519230300
                        )

                )

            [wspd] => stdClass Object
                (
                    [max] => 15
                    [values] => Array
                        (
                            [0] => 1.0088865756989
                            [1] => 0.9665704369545
                            [2] => 1.1251744031906
                            [3] => 1.2365250587463
                            [4] => 1.1603840589523
                            [5] => 0.43476566672325
                            [6] => 0.94910037517548
                            [7] => 1.3876720666885
                            [8] => 1.5719583034515
                            [9] => 1.5942039489746
                            [10] => 1.4560458660126
                            [11] => 1.4107797145844
                            [12] => 1.6427295207977
                            [13] => 2.0294351577759
                            [14] => 2.3619017601013
                            [15] => 2.551441192627
                            [16] => 2.22634100914
                            [17] => 2.0733733177185
                            [18] => 1.9880610704422
                            [19] => 2.1257786750793
                            [20] => 1.9468450546265
                            [21] => 1.715470790863
                            [22] => 1.538910984993
                            [23] => 1.5265828371048
                            [24] => 1.6841045618057
                            [25] => 2.1887700557709
                            [26] => 2.5749959945679
                            [27] => 3.040180683136
                            [28] => 3.4166719913483
                            [29] => 2.8134350776672
                            [30] => 2.559583902359
                            [31] => 1.8931291103363
                            [32] => 1.8339611291885
                            [33] => 1.7814992666245
                            [34] => 1.9860609769821
                            [35] => 2.1812052726746
                            [36] => 2.2499816417694
                            [37] => 2.3161845207214
                            [38] => 2.4586458206177
                            [39] => 2.7298998832703
                            [40] => 2.7237448692322
                            [41] => 2.6624627113342
                            [42] => 2.6649451255798
                            [43] => 2.7470202445984
                            [44] => 2.5704281330109
                            [45] => 2.5557279586792
                            [46] => 2.6291182041168
                            [47] => 2.4697768688202
                            [48] => 2.708655834198
                            [49] => 3.0756440162659
                            [50] => 3.1295454502106
                            [51] => 3.0135507583618
                            [52] => 2.216949224472
                            [53] => 3.0555958747864
                            [54] => 3.0539436340332
                            [55] => 3.3212549686432
                            [56] => 3.0587141513824
                            [57] => 2.5044224262238
                            [58] => 2.5811448097229
                            [59] => 2.8080377578735
                            [60] => 2.934413433075
                            [61] => 2.7698266506195
                            [62] => 2.6921646595001
                            [63] => 2.4498970508575
                            [64] => 2.4997797012329
                            [65] => 2.5653886795044
                            [66] => 2.5244936943054
                            [67] => 2.2655551433563
                            [68] => 1.8760204315186
                            [69] => 2.5536222457886
                            [70] => 2.6481256484985
                            [71] => 2.6176569461823
                            [72] => 2.7069406509399
                            [73] => 2.6880729198456
                            [74] => 2.8569850921631
                            [75] => 3.2475590705872
                            [76] => 3.2488143444061
                            [77] => 2.753310918808
                            [78] => 2.5161826610565
                        )

                    [unit] => stdClass Object
                        (
                            [cz] => m/s
                            [gb] => m/s
                        )

                    [gridStep] => 1
                    [min] => 0
                )

            [cloud_mid] => stdClass Object
                (
                    [max] => 1
                    [values] => Array
                        (
                            [0] => 0
                            [1] => 0
                            [2] => 0
                            [3] => 0
                            [4] => 0
                            [5] => 0
                            [6] => 0
                            [7] => 0
                            [8] => 0
                            [9] => 0
                            [10] => 0
                            [11] => 0.0050772214308381
                            [12] => 0
                            [13] => 0
                            [14] => 0
                            [15] => 0
                            [16] => 0.056654460728168
                            [17] => 0.19139635562897
                            [18] => 0.24677112698555
                            [19] => 0.23078985512257
                            [20] => 0.28405356407166
                            [21] => 0.52911233901978
                            [22] => 0.488430082798
                            [23] => 0.33206212520599
                            [24] => 0.22520524263382
                            [25] => 0.35459065437317
                            [26] => 0.45337575674057
                            [27] => 0.50251376628876
                            [28] => 0.61584424972534
                            [29] => 0.68367475271225
                            [30] => 0.84554606676102
                            [31] => 0.42810714244843
                            [32] => 0.73997610807419
                            [33] => 0.85212677717209
                            [34] => 0.87378704547882
                            [35] => 1
                            [36] => 1
                            [37] => 1
                            [38] => 0.77467167377472
                            [39] => 0.76730620861053
                            [40] => 0.72990500926971
                            [41] => 0.62999308109283
                            [42] => 0.43041482567787
                            [43] => 0.27942317724228
                            [44] => 0.28977191448212
                            [45] => 0.069169580936432
                            [46] => 0.091005407273769
                            [47] => 0.84361070394516
                            [48] => 0.93406057357788
                            [49] => 0.84271347522736
                            [50] => 1
                            [51] => 1
                            [52] => 0.40604230761528
                            [53] => 0.068654932081699
                            [54] => 0.029129933565855
                            [55] => 0
                            [56] => 0
                            [57] => 0
                            [58] => 0
                            [59] => 0
                            [60] => 0
                            [61] => 0
                            [62] => 0
                            [63] => 0
                            [64] => 0
                            [65] => 0
                            [66] => 0
                            [67] => 0
                            [68] => 0
                            [69] => 0
                            [70] => 0
                            [71] => 0
                            [72] => 0
                            [73] => 0
                            [74] => 0
                            [75] => 0
                            [76] => 0
                            [77] => 0
                            [78] => 0.040368780493736
                        )

                    [unit] => stdClass Object
                        (
                            [cz] => %
                            [gb] => %
                        )

                    [min] => 0
                )

            [rain_dif] => stdClass Object
                (
                    [max] => 10
                    [values] => Array
                        (
                            [0] => 1.5844293908874E-16
                            [1] => 8.4258443609444E-17
                            [2] => 0
                            [3] => 0
                            [4] => 0
                            [5] => 0
                            [6] => 0
                            [7] => 0
                            [8] => 0
                            [9] => 0
                            [10] => 0
                            [11] => 0
                            [12] => 0
                            [13] => 2.6631449823178E-10
                            [14] => 0.00024449802003801
                            [15] => 0.0015146411024034
                            [16] => 0.0005183681496419
                            [17] => 1.7768023099052E-5
                            [18] => 0
                            [19] => 0
                            [20] => 0
                            [21] => 0
                            [22] => 0
                            [23] => 0
                            [24] => 0
                            [25] => 0
                            [26] => 0
                            [27] => 0
                            [28] => 0
                            [29] => 0
                            [30] => 0
                            [31] => 0
                            [32] => 0
                            [33] => 0
                            [34] => 0
                            [35] => 0
                            [36] => 0
                            [37] => 0
                            [38] => 0
                            [39] => 0
                            [40] => 0
                            [41] => 0
                            [42] => 0
                            [43] => 0
                            [44] => 0
                            [45] => 0
                            [46] => 0
                            [47] => 0
                            [48] => 0
                            [49] => 0
                            [50] => 0
                            [51] => 0
                            [52] => 0
                            [53] => 0
                            [54] => 0
                            [55] => 0
                            [56] => 0
                            [57] => 0
                            [58] => 0
                            [59] => 0
                            [60] => 0
                            [61] => 0
                            [62] => 0
                            [63] => 0
                            [64] => 0
                            [65] => 0
                            [66] => 0
                            [67] => 0
                            [68] => 0
                            [69] => 0
                            [70] => 0
                            [71] => 0
                            [72] => 0
                            [73] => 0
                            [74] => 0
                            [75] => 0
                            [76] => 0
                            [77] => 0
                        )

                    [unit] => stdClass Object
                        (
                            [cz] => mm/h
                            [gb] => mm/h
                        )

                    [gridStep] => 1
                    [min] => 0
                )

            [cloud_high] => stdClass Object
                (
                    [max] => 1
                    [values] => Array
                        (
                            [0] => 0
                            [1] => 0
                            [2] => 0
                            [3] => 0
                            [4] => 0
                            [5] => 0
                            [6] => 0
                            [7] => 0
                            [8] => 0
                            [9] => 0
                            [10] => 0.02511184848845
                            [11] => 0
                            [12] => 0
                            [13] => 0
                            [14] => 0
                            [15] => 0
                            [16] => 0.10017077624798
                            [17] => 0.13978946208954
                            [18] => 0.1885012537241
                            [19] => 0.16186068952084
                            [20] => 0.069852784276009
                            [21] => 0.079467065632343
                            [22] => 0.035575270652771
                            [23] => 0.0058384146541357
                            [24] => 0.094236746430397
                            [25] => 0.052728474140167
                            [26] => 0.10659223794937
                            [27] => 0.27810934185982
                            [28] => 0.45064294338226
                            [29] => 0.4440923333168
                            [30] => 0.37557083368301
                            [31] => 0.5423948764801
                            [32] => 0.72559595108032
                            [33] => 0.57534658908844
                            [34] => 0.64419203996658
                            [35] => 0.68366330862045
                            [36] => 0.60395348072052
                            [37] => 0.50553643703461
                            [38] => 0.39264637231827
                            [39] => 0.43709510564804
                            [40] => 0.28939390182495
                            [41] => 0.17290477454662
                            [42] => 0.080580428242683
                            [43] => 0.032660972326994
                            [44] => 0.025362577289343
                            [45] => 0.047992676496506
                            [46] => 0.076282322406769
                            [47] => 0.01001453679055
                            [48] => 0.13670259714127
                            [49] => 0.11128430813551
                            [50] => 0
                            [51] => 0
                            [52] => 0
                            [53] => 0
                            [54] => 0.0093076471239328
                            [55] => 0
                            [56] => 0
                            [57] => 0
                            [58] => 0
                            [59] => 0
                            [60] => 0
                            [61] => 0
                            [62] => 0
                            [63] => 0
                            [64] => 0
                            [65] => 0
                            [66] => 0
                            [67] => 0
                            [68] => 0
                            [69] => 0
                            [70] => 0
                            [71] => 0
                            [72] => 0
                            [73] => 0
                            [74] => 0
                            [75] => 0
                            [76] => 0
                            [77] => 0
                            [78] => 0
                        )

                    [unit] => stdClass Object
                        (
                            [cz] => %
                            [gb] => %
                        )

                    [min] => 0
                )

        )

    [lon] => 14.3954363
)
            */
            die();
        }
    }
?>